# L·ªánh Test Malware

## ‚ö†Ô∏è C·∫¢NH B√ÅO
**CH·ªà CH·∫†Y TRONG VM/SANDBOX, KH√îNG CH·∫†Y TR√äN M√ÅY TH·∫¨T!**

## üìã Y√™u C·∫ßu Tr∆∞·ªõc Khi Test

1. **Models ƒë√£ ƒë∆∞·ª£c train** (trong th∆∞ m·ª•c `models/`)
2. **M√¥i tr∆∞·ªùng c√°ch ly** (VM ho·∫∑c sandbox)
3. **File malware sample** ƒë·ªÉ test

---

## üîß C√°c L·ªánh Test

### 1. Test M·ªôt File ƒê∆°n L·∫ª

#### V·ªõi Random Forest Model:
```powershell
python scripts/test_malware.py "C:\path\to\malware.exe" --model models/random_forest_model.pkl --model-type random_forest --output results/malware_test.json
```

#### V·ªõi XGBoost Model:
```powershell
python scripts/test_malware.py "C:\path\to\malware.exe" --model models/xgboost_model.json --model-type xgboost --output results/malware_test.json
```

#### V·ªõi Neural Network Model:
```powershell
python scripts/test_malware.py "C:\path\to\malware.exe" --model models/neural_network_model.pt --model-type neural_network --output results/malware_test.json
```

### 2. Test Nhi·ªÅu Files (Batch Test)

#### Test t·∫•t c·∫£ files trong m·ªôt th∆∞ m·ª•c:
```powershell
python scripts/batch_test.py "C:\malware_test\" --model models/random_forest_model.pkl --model-type random_forest --output results/batch_results.json
```

#### Test ƒë·ªá quy (bao g·ªìm c·∫£ subdirectories):
```powershell
python scripts/batch_test.py "C:\malware_test\" --model models/random_forest_model.pkl --model-type random_forest --output results/batch_results.json --recursive
```

### 3. Test v·ªõi T·∫•t C·∫£ Models (So S√°nh)

```powershell
# Test v·ªõi Random Forest
python scripts/test_malware.py "C:\path\to\malware.exe" --model models/random_forest_model.pkl --model-type random_forest

# Test v·ªõi XGBoost
python scripts/test_malware.py "C:\path\to\malware.exe" --model models/xgboost_model.json --model-type xgboost

# Test v·ªõi Neural Network
python scripts/test_malware.py "C:\path\to\malware.exe" --model models/neural_network_model.pt --model-type neural_network
```

### 4. Test qua Dashboard (Web UI)

```powershell
# Kh·ªüi ƒë·ªông dashboard
python main.py dashboard
```

Sau ƒë√≥ m·ªü browser: **http://localhost:5000** v√† upload file ƒë·ªÉ test.

---

## üìä V√≠ D·ª• Th·ª±c T·∫ø

### V√≠ d·ª• 1: Test file trong th∆∞ m·ª•c upload
```powershell
python scripts/test_malware.py "data\upload\sample.exe" --model models/random_forest_model.pkl --model-type random_forest --output results/sample_test.json
```

### V√≠ d·ª• 2: Batch test t·∫•t c·∫£ files trong data/upload
```powershell
python scripts/batch_test.py "data\upload\" --model models/random_forest_model.pkl --model-type random_forest --output results/upload_batch_test.json
```

### V√≠ d·ª• 3: Test v·ªõi ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi
```powershell
python scripts/test_malware.py "D:\MalwareSamples\test.exe" --model models/xgboost_model.json --model-type xgboost
```

---

## üìà Xem K·∫øt Qu·∫£

### K·∫øt qu·∫£ hi·ªÉn th·ªã tr√™n console:
```
==================================================
K·∫æT QU·∫¢ PH√ÇN T√çCH
==================================================
File: C:\path\to\malware.exe
K·∫øt qu·∫£: Obfuscated
ƒê·ªô tin c·∫≠y: 95.23%
X√°c su·∫•t Benign: 4.77%
X√°c su·∫•t Obfuscated: 95.23%
Model: random_forest
==================================================
```

### K·∫øt qu·∫£ l∆∞u trong file JSON:
```json
{
  "sample": "C:\\path\\to\\malware.exe",
  "results": {
    "prediction": "Obfuscated",
    "confidence": 0.9523,
    "probabilities": {
      "benign": 0.0477,
      "obfuscated": 0.9523
    },
    "model_type": "random_forest"
  },
  "feature_count": 1234
}
```

---

## üîç Gi·∫£i Th√≠ch K·∫øt Qu·∫£

- **Benign**: File kh√¥ng b·ªã obfuscate (ho·∫∑c obfuscation nh·∫π)
- **Obfuscated**: File c√≥ d·∫•u hi·ªáu obfuscation (c√≥ th·ªÉ l√† malware)

**ƒê·ªô tin c·∫≠y:**
- **> 90%**: R·∫•t cao
- **70-90%**: Cao
- **50-70%**: Trung b√¨nh
- **< 50%**: Th·∫•p (c·∫ßn ki·ªÉm tra l·∫°i)

---

## ‚ö° L·ªánh Nhanh (Quick Commands)

### Test nhanh v·ªõi Random Forest:
```powershell
python scripts/test_malware.py "FILE_PATH" --model models/random_forest_model.pkl --model-type random_forest
```

### Batch test nhanh:
```powershell
python scripts/batch_test.py "DIRECTORY_PATH" --model models/random_forest_model.pkl --model-type random_forest
```

---

## ‚ùå X·ª≠ L√Ω L·ªói

### L·ªói: "Model not found"
**Gi·∫£i ph√°p**: ƒê·∫£m b·∫£o ƒë√£ train models tr∆∞·ªõc:
```powershell
python main.py train
```

### L·ªói: "No features extracted"
**Gi·∫£i ph√°p**: 
- Ki·ªÉm tra file c√≥ ph·∫£i binary h·ª£p l·ªá
- Ki·ªÉm tra architecture (x86, x64)

### L·ªói: "Feature dimension mismatch"
**Gi·∫£i ph√°p**: 
- ƒê·∫£m b·∫£o extract features v·ªõi c√πng config nh∆∞ khi train
- Retrain models n·∫øu c·∫ßn

---

## üìù L∆∞u √ù

1. **Lu√¥n test trong VM/sandbox**
2. **Kh√¥ng ch·∫°y file malware th·∫≠t** (ch·ªâ ph√¢n t√≠ch static)
3. **Backup d·ªØ li·ªáu** tr∆∞·ªõc khi test
4. **T·∫Øt network** khi test trong VM
5. **Snapshot VM** tr∆∞·ªõc khi test

---

## üéØ Workflow Ho√†n Ch·ªânh

```powershell
# 1. ƒê·∫£m b·∫£o models ƒë√£ ƒë∆∞·ª£c train
python main.py train

# 2. Test m·ªôt file
python scripts/test_malware.py "C:\malware\sample.exe" --model models/random_forest_model.pkl --model-type random_forest

# 3. Batch test nhi·ªÅu files
python scripts/batch_test.py "C:\malware\" --model models/random_forest_model.pkl --model-type random_forest --output results/batch.json

# 4. Xem k·∫øt qu·∫£
cat results/batch.json
```


